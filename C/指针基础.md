# 指针基础 #
上一节，我们剑走偏锋，脱离了书本上的纲要，以两个最简单的例子引出了指针的概念。进而，我们理解了指针的概念，学到了取址“&”操作符和解引用“*”操作符。尽管弄懂了指针的本质，但是如何使用却依然陌生。这一节便系统的论述一下指针的具体使用方法，此外，重要的事情只说一遍：<font color=red>如果对于指针的概念依然很模糊，劳烦将上一节的内容多看几遍，对照着程序多调几遍，反复摩擦，你的智商总会上线。</font>

## 指针的定义 ##
指针是一种较为泛化的变量，他可以指向任何一种其他类型的变量，甚至可以指向某种指针类型。便于理解，可以将指向某种类型的指针当成是一种类型，比如指向int型的叫int型指针，指向float型的叫float型指针，当然，还会有前面提到的颇为绕口的指向指向int型变量的指针的指针。

指针的定义很简单，我们以int型和float型为例：
	
	```
	int *pInt;
	float *pFloat;
	```

按如上的写法，便可以定义出一个int型指针变量pInt和一个float型指针变量pFloat。
看到这里，你不禁会问，这两个二货指向谁呢？又如何赋值呢？赋值之前又是什么样的初始值？

其实，如果你认真调试了上一节的程序，那么这几个问题应该难不倒你。指针在定义时，如果没有做初始化操作，那么以行业术语来说，此时的指针是一个野指针。而之所以称之为野指针，是因为它的初始值是一个“随机数”（日后你会明白它是栈上的垃圾数据或编译器精心准备过的数据），既然是一个随机数作为地址，那么这个地址的值是不可预估的，甚至地址本身的值也存在着越界的危险（不是所有4G范围内的地址都能让你一个小应用程序折腾的）。

## 赋值与初始化 ##
到此，第一和第三疑问已然了然，那么剩下的赋值作何解？且看：

	```
	int val = 3;
	float f = 4.8;
	
	pInt = &val;
	pFloat = &f;
	```

我接着定义了两个变量val和f，下面的两个赋值语句即让pInt指向了val，pFloat指向了f，&操作符你已经认识了，所以，看到这里，所谓的指向实际上不也就是个赋值嘛，无非就是把这两个变量的地址值放在了指针变量中。

另一方面，细心的童鞋应该注意到，上文曾提到过，如果一个指针变量定义时未做初始化操作，方才是一个野指针。那么问题来了，初始化又是如何写？

	```
	double d = 3.4L;
	double *pDouble = &d;	//initialize point var
	```

## 空指针与void * ##
学会了指针的赋值以及初始化，自然就会想到这样一个问题：我先定义一个指针变量，但是想要在后面才赋值，没有办法初始化。但是又觉着野指针很危险，怕后面勿用，该怎么办呢？

C的设计者一早便想到了这样一个问题，于是便有一个常用的宏NULL(#define NULL 0)来去为这种指针进行初始化，或者赋值：

	```
	int *p = NULL;
	
	float *f;
	f = NULL;
	```

以上的内容想必都十分简单，一目了然。接下来，我们说一个重头戏：`void *`。
可能第一眼看上去，你会很疑惑，字面意思来看：“指向一个空类型的指针？等等，空类型是什么鬼类型，既然是空类型又何必要指针指向？”。
实际上，`void *`中的void并不代表我们常见的空，而在这里，是任意类型的意思。因此，`void *`实际上是指向任意类型的指针。误会是解除了，但是仔细想想，却又不以为然，方才不是说过，指针类型有很多种，指向每一种变量类型的指针都是一种类型吗？而关于此，实际上并不矛盾，就像变量有强制类型转换一样，指针也可以，比如，我想设计一个函数，其参数可以是泛型的，对于C来说，我们可以设计这样的万用接口：

	```
	int func(void *p);
	
	//call func
	int a = 3;
	func((void *)&a);
	
	float f = 3.2;
	func((void *)&f);
	```
至于func内部如何鉴别p，等到你对C这门语言融会贯通时，自然清楚。当前限于难度，就不做展开。

同理，指针的强制类型转换不限于到`void *`的转换，只是，使用的时候需要格外注意，日后用到便知。

## 经典的例子 ##
最后，我们以一个经典的例子来结束本节。

	```
	void swap(int *pA, int *pB)
	{
		int temp;
		temp = *pA;
		*pA = *pB;
		*pB = temp;
	}
	
	int main()
	{
		int a = 3, b = 5;
		//int *pA = &a, *pB = &b;
	
		printf("before swap: a=%d, b=%d\n", a, b);
		//swap(pA,pB);
		swap(&a,&b);
		printf("after swap: a=%d, b=%d\n", a, b);
	}
	```

仔细阅读这段程序，用调试器调试并跟踪每一个变量的值。思考一下我注释掉的两行内容是何意义？